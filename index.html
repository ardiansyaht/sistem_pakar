<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Forward Chaining Penyakit Tanaman Cabai</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        background-color: #f4f4f9;
        margin: 0;
        padding: 0;
      }
      .container {
        width: 80%;
        margin: 30px auto;
        padding: 20px;
        background-color: #fff;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      }
      h1,
      h2 {
        text-align: center;
        color: #4caf50;
      }
      .form-group {
        margin-bottom: 15px;
      }
      button {
        padding: 10px 20px;
        background-color: #4caf50;
        color: white;
        border: none;
        cursor: pointer;
        border-radius: 5px;
        display: block;
        width: 100%;
      }
      button:hover {
        background-color: #45a049;
      }
      .result {
        margin-top: 20px;
        text-align: center;
        padding: 10px;
        background-color: #f9f9f9;
        border: 1px solid #ddd;
      }
      table {
        width: 100%;
        margin-top: 20px;
        border-collapse: collapse;
      }
      table,
      th,
      td {
        border: 1px solid #ddd;
      }
      th,
      td {
        padding: 8px;
        text-align: center;
      }
      th {
        background-color: #4caf50;
        color: white;
      }
      tr:nth-child(even) {
        background-color: #f2f2f2;
      }
      tr:hover {
        background-color: #ddd;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h2>Daftar Penyakit</h2>
      <table>
        <thead>
          <tr>
            <th>No</th>
            <th>Kode Penyakit</th>
            <th>Nama Penyakit</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>1</td>
            <td>T01</td>
            <td>Penyakit Layu Bakteri (Pseudomonas solanacearum)</td>
          </tr>
          <tr>
            <td>2</td>
            <td>T02</td>
            <td>Penyakit Antraknosa (Patek)</td>
          </tr>
          <tr>
            <td>3</td>
            <td>T03</td>
            <td>Penyakit Embun Tepung (Oidium sp.)</td>
          </tr>
          <tr>
            <td>4</td>
            <td>T04</td>
            <td>Trips (Triphs tabacci)</td>
          </tr>
          <tr>
            <td>5</td>
            <td>T05</td>
            <td>Kutu Kebul (Vektor Virus Kuning - Gemini Virus)</td>
          </tr>
          <tr>
            <td>6</td>
            <td>T06</td>
            <td>Layu Fusarium (Fusarium oxysporum)</td>
          </tr>
          <tr>
            <td>7</td>
            <td>T07</td>
            <td>Virus Kuning (Gemini Virus)</td>
          </tr>
          <tr>
            <td>8</td>
            <td>T08</td>
            <td>Busuk Buah (Antraknose, Colletotrichum spp.)</td>
          </tr>
          <tr>
            <td>9</td>
            <td>T09</td>
            <td>Busuk Akar (Phytophthora capsici)</td>
          </tr>
        </tbody>
      </table>

      <h2>Aturan Diagnosa (IF-THEN)</h2>
      <table>
        <thead>
          <tr>
            <th>No</th>
            <th>Kondisi (IF)</th>
            <th>Tindakan (THEN)</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>1</td>
            <td>G001, G002, G003, G004, G005, G006, G007</td>
            <td>T01 - Layu Bakteri</td>
          </tr>
          <tr>
            <td>2</td>
            <td>G006, G007, G008, G009, G010, G011</td>
            <td>T02 - Antraknosa</td>
          </tr>
          <tr>
            <td>3</td>
            <td>G008, G009, G010</td>
            <td>T03 - Embun Tepung</td>
          </tr>
          <tr>
            <td>4</td>
            <td>G012, G013</td>
            <td>T04 - Trips</td>
          </tr>
          <tr>
            <td>5</td>
            <td>G016, G017, G018</td>
            <td>T07 - Virus Kuning</td>
          </tr>
          <tr>
            <td>6</td>
            <td>G014, G015</td>
            <td>T06 - Layu Fusarium</td>
          </tr>
          <tr>
            <td>7</td>
            <td>G019, G020</td>
            <td>T08 - Busuk Buah</td>
          </tr>
          <tr>
            <td>8</td>
            <td>G021</td>
            <td>T09 - Busuk Akar</td>
          </tr>
        </tbody>
      </table>

      <h2>Diagnosa Penyakit Tanaman Cabai</h2>
      <form id="diagnosisForm">
        <div id="checkboxes"></div>
        <button type="button" onclick="diagnosis()">Diagnosa</button>
      </form>
      <div id="result" class="result"></div>
    </div>

    <script>
      const gejalaList = [
        "Daun kuning pucat mulai dari pangkal ke ujung",
        "Tanaman kerdil dan layu",
        "Batang berwarna coklat kemerahan saat dipotong",
        "Buah tampak normal tapi busuk di dalamnya (coklat-hitam)",
        "Luka kecil pada buah yang berkembang membesar",
        "Buah mengering",
        "Kerusakan buah mencapai 20-90% (musim hujan)",
        "Lapisan putih seperti tepung di daun",
        "Daun mengalami malformasi (pertumbuhan tidak normal)",
        "Daun mengering tanpa gugur",
        "Buah muda gugur",
        "Daun terdapat strip keperakan",
        "Daun muda keriput dan kering",
        "Daun menguning dari bawah ke atas",
        "Akar dan batang bagian bawah berwarna coklat",
        "Daun pucuk menunjukkan vein clearing",
        "Tulang daun menebal dan menggulung ke atas",
        "Daun mengecil, kuning terang, tanaman kerdil dan tidak berbuah",
        "Bercak buah hitam/oranye/coklat mengkilap, sedikit terbenam dan berair",
        "Luka membesar, membentuk lingkaran konsentris pada buah",
        "Akar membusuk setelah hujan lebat",
      ];

      const rules = [
        { kode: "T01", nama: "Layu Bakteri", gejala: [1, 2, 3, 4, 5, 6, 7] },
        { kode: "T02", nama: "Antraknosa", gejala: [6, 7, 8, 9, 10, 11] },
        { kode: "T03", nama: "Embun Tepung", gejala: [8, 9, 10] },
        { kode: "T04", nama: "Trips", gejala: [12, 13] },
        { kode: "T05", nama: "Kutu Kebul", gejala: [14] },
        { kode: "T06", nama: "Layu Fusarium", gejala: [14, 15] },
        { kode: "T07", nama: "Virus Kuning", gejala: [16, 17, 18] },
        { kode: "T08", nama: "Busuk Buah", gejala: [19, 20] },
        { kode: "T09", nama: "Busuk Akar", gejala: [21] },
      ];

      const container = document.getElementById("checkboxes");
      gejalaList.forEach((desc, index) => {
        const div = document.createElement("div");
        div.className = "form-group";
        const checkbox = document.createElement("input");
        checkbox.type = "checkbox";
        checkbox.id = `G${(index + 1).toString().padStart(3, "0")}`;
        const label = document.createElement("label");
        label.htmlFor = checkbox.id;
        label.innerText = `Gejala ${index + 1}: ${desc} (${checkbox.id})`;
        div.appendChild(label);
        div.appendChild(checkbox);
        container.appendChild(div);
      });

      function diagnosis() {
        const gejalaInput = {};
        let semuaTercentang = true;

        gejalaList.forEach((_, i) => {
          const key = `G${(i + 1).toString().padStart(3, "0")}`;
          const isChecked = document.getElementById(key).checked;
          gejalaInput[key] = isChecked;
          if (!isChecked) semuaTercentang = false;
        });

        let hasilOutput = "<strong>Hasil Diagnosa:</strong><br>";

        if (semuaTercentang) {
          hasilOutput += `<br><strong>Kesimpulan:</strong> Penyakit tidak diketahui karena semua gejala dipilih.</strong>`;
          document.getElementById("result").innerHTML = hasilOutput;
          return;
        }

        let max = 0;
        let tertinggi = "";

        rules.forEach((rule) => {
          const cocok = rule.gejala.filter(
            (k) => gejalaInput[`G${k.toString().padStart(3, "0")}`]
          ).length;
          const total = rule.gejala.length;
          const persen = Math.round((cocok / total) * 100);
          hasilOutput += `- ${rule.nama}: ${persen}%<br>`;
          if (persen > max) {
            max = persen;
            tertinggi = rule.nama;
          }
        });

        hasilOutput += `<br><strong>Kesimpulan:</strong> Kemungkinan terbesar adalah <strong>${
          tertinggi || "Penyakit tidak diketahui"
        }</strong>`;
        document.getElementById("result").innerHTML = hasilOutput;
      }
    </script>
  </body>
</html>
